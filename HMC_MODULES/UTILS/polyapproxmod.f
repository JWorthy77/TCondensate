      module polyapproxmod
      use pacc
      implicit none

      contains

      subroutine getPolyCoeffs(func,order,r1,r2,cfs)
      implicit none
      integer func,order
      real(prc) r1,r2
      real(prc),allocatable,dimension(:) :: cfs
      real(prc) c0,c1,c2,c3,c4,c5,c6

      allocate(cfs(order+1))
      if (func.eq.1) then ! 1/(x+2) - for Wilson range [1,5]
        if (order.eq.4) then
!     [1,5] e=2e-4
      c4=0.000432936215710 ; cfs(5)=c4 ;
      c3=-0.007179197568107 ; cfs(4)=c3 ;
      c2=0.049008215315665 ; cfs(3)=c2 ;
      c1=-0.186560905503079 ; cfs(2)=c1 ;
      c0=0.477451566774172 ; cfs(1)=c0 ;
        elseif(order.eq.6) then
!     [1,5] e=8e-6
      c6=0.000018859034300 ; cfs(7)=c6;
      c5=-0.000425885561912 ; cfs(6)=c5;
      c4=0.004143236771787 ; cfs(5)=c4;
      c3=-0.023124867467869 ; cfs(4)=c3;
      c2=0.084483556885231 ; cfs(3)=c2;
      c1=-0.225037261843053 ; cfs(2)=c1;
      c0=0.493267823303808 ; cfs(1)=c0;
        elseif(order.eq.10) then
!     [1,5] e=2e-8
      cfs(11)=3.57857679505796e-08
      cfs(10)=-1.2375640280254e-06
      cfs(9)=1.93488630932383e-05
      cfs(8)=-0.000181636587601821
      cfs(7)=0.00114953833836862
      cfs(6)=-0.00524315299982974
      cfs(5)=0.0181312104060993
      cfs(4)=-0.0500088404866318
      cfs(3)=0.116769355990109
      cfs(2)=-0.246701170360492
      cfs(1)=0.49939986701063
        elseif(order.eq.14) then
!     [1,5] e=3e-11
      cfs(15)=6.79063082940281e-11
      cfs(14)=-3.16324294869306e-09
      cfs(13)=6.82914716296518e-08
      cfs(12)=-9.08377884727346e-07
      cfs(11)=8.35355099578033e-06
      cfs(10)=-5.65527096035071e-05
      cfs(9)=0.000293537793119966
      cfs(8)=-0.0012046384887735
      cfs(7)=0.00401879212714245
      cfs(6)=-0.0112293300898706
      cfs(5)=0.0272319704826457
      cfs(4)=-0.0597475888498109
      cfs(3)=0.1236833631465
      cfs(2)=-0.249610232898348
      cfs(1)=0.499946502422741
        else
      print *,"bad choice of poly order"
      stop
        endif
      elseif (func.eq.2) then ! 1/x^-0.5 - for Wilson range [1,5] 

        if(order.eq.4) then ! e=3e-3
      cfs(5)=0.00439328202764539
      cfs(4)=-0.0642482405336539
      cfs(3)=0.359515022732059
      cfs(2)=-0.987427288960756
      cfs(1)=1.68473524808266
        elseif(order.eq.6) then ! e=4e-4
      cfs(7)=0.000533840238439
      cfs(6)=-0.010938123059684
      cfs(5)=0.092660571172164
      cfs(4)=-0.420650839708507
      cfs(3)=1.112318335348695
      cfs(2)=-1.769295809200460
      cfs(1)=1.994992549930414
        elseif(order.eq.8) then ! e=5e-5
      cfs(9)=6.81805123785341e-05
      cfs(8)=-0.00180165240973962
      cfs(7)=0.0205734892939158
      cfs(6)=-0.133071002841547
      cfs(5)=0.537051431401971
      cfs(4)=-1.40522372590266
      cfs(3)=2.40449969209753
      cfs(2)=-2.6850167862481
      cfs(1)=2.2628711177222
        elseif(order.eq.10)then ! e=7e-6
      cfs(11)=0.000008957746494
      cfs(10)=-0.000290110077343
      cfs(9)=0.004174735765176
      cfs(8)=-0.035193996227528
      cfs(7)=0.192944305630676
      cfs(6)=-0.721954685172522
      cfs(5)=1.882465124752294
      cfs(4)=-3.430655352346351
      cfs(3)=4.323805829293945
      cfs(2)=-3.717433446824960
      cfs(1)=2.502122099472023
        elseif(order.eq.12)then ! e=9e-7

      cfs(13)=1.19863871389249e-06
      cfs(12)=-4.59812368706936e-05
      cfs(11)=0.000798765427833955
      cfs(10)=-0.00831240796337868
      cfs(9)=0.0577683655049963
      cfs(8)=-0.282924778051444
      cfs(7)=1.00419409466995
      cfs(6)=-2.61555256421495
      cfs(5)=5.00496998231724
      cfs(4)=-6.97372747384513
      cfs(3)=6.94715300563491
      cfs(2)=-4.85467483985421
      cfs(1)=2.72035175192744

        elseif(order.eq.14)then ! e=2e-7
      cfs(15)=1.62459910996268e-07
      cfs(14)=-7.20400467068993e-06
      cfs(13)=0.000146663310450604
      cfs(12)=-0.00181720503607675
      cfs(11)=0.015314506029166
      cfs(10)=-0.0929282837643724
      cfs(9)=0.419207694403549
      cfs(8)=-1.43104027882997
      cfs(7)=3.72677875585178
      cfs(6)=-7.40727748300464
      cfs(5)=11.1609713918984
      cfs(4)=-12.5676054562796
      cfs(3)=10.3438482519931
      cfs(2)=-6.08788454860516
      cfs(1)=2.92229291354316

        elseif(order.eq.16)then ! e=2e-8

      cfs(17)=2.22226843533584e-08
      cfs(16)=-1.11848960822796e-06
      cfs(15)=2.61162010825224e-05
      cfs(14)=-0.00037551841505825
      cfs(13)=0.00372201036795287
      cfs(12)=-0.0269729004910775
      cfs(11)=0.147917364485687
      cfs(10)=-0.626718758203606
      cfs(9)=2.07632450370678
      cfs(8)=-5.40866528444191
      cfs(7)=11.079233634245
      cfs(6)=-17.7564365673692
      cfs(5)=22.0292229372019
      cfs(4)=-20.7953918535474
      cfs(3)=14.5769882048536
      cfs(2)=-7.4099823835186
      cfs(1)=3.11110957469765

        else
      print *,"bad choice of poly order"
      stop
        endif
  
      elseif (func.eq.3) then ! 1/x^0.5 - for Wilson range [1,25]
        if(order.eq.100) then ! non-weightg - e=3e-3
      cfs(11)=0.000000000037664
      cfs(10)=-0.000000005106708
      cfs(9)=0.000000299490670
      cfs(8)=-0.000009958522114
      cfs(7)=0.000206884613310
      cfs(6)=-0.002792110689493
      cfs(5)=0.024703908733986
      cfs(4)=-0.141680197809713
      cfs(3)=0.512553758646465
      cfs(2)=-1.134062695887773
      cfs(1)=1.738170736876603
        elseif(order.eq.10) then ! weighted - e=5e-3
      cfs(11)=2.15727740647458e-11
      cfs(10)=-3.01230936863511e-09
      cfs(9)=1.82603439280475e-07
      cfs(8)=-6.30308082033376e-06
      cfs(7)=0.000136617286616794
      cfs(6)=-0.00193496524105069
      cfs(5)=0.0180868799829357
      cfs(4)=-0.11038137122279
      cfs(3)=0.427877889352025
      cfs(2)=-1.01918316506821
      cfs(1)=1.68042546345216
        elseif(order.eq.140) then ! non-weighted - e=6e-4
      cfs(15)=4.9593935928774e-15
      cfs(14)=-9.29530475782749e-13
      cfs(13)=7.85722013951439e-11
      cfs(12)=-3.96002012754523e-09
      cfs(11)=1.32573129775035e-07
      cfs(10)=-3.10916140322489e-06
      cfs(9)=5.25075168068802e-05
      cfs(8)=-0.000646569981269294
      cfs(7)=0.00581658798403159
      cfs(6)=-0.0379721225925291
      cfs(5)=0.177244595907058
      cfs(4)=-0.578060233001574
      cfs(3)=1.27702273982579
      cfs(2)=-1.85509209559684
      cfs(1)=2.01113558284937
        elseif(order.eq.14) then ! weighted - e=9e-4
      cfs(15)=2.81998893235561e-15
      cfs(14)=-5.39901375182806e-13
      cfs(13)=4.67041112443543e-11
      cfs(12)=-2.4139069269733e-09
      cfs(11)= 8.3066828002513e-08
      cfs(10)=-2.00770132433125e-06
      cfs(9)=3.50451985162466e-05
      cfs(8)=-0.000447484904671241
      cfs(7)=0.00418909912854504
      cfs(6)=-0.0285652015320975
      cfs(5)=0.139803336388673
      cfs(4)=-0.479751745077681
      cfs(3)=1.11813846705603
      cfs(2)=-1.71534787964258
      cfs(1)=1.96109394106476
        elseif(order.eq.180) then ! non-weighted - e=9e-5
      cfs(19)=6.75376675877626e-19
      cfs(18)=-1.61645004096163e-16
      cfs(17)=1.78560883070453e-14
      cfs(16)=-1.20770315881598e-12
      cfs(15)=5.59479593207283e-11
      cfs(14)=-1.88164031168511e-09
      cfs(13)=4.75165282138488e-08
      cfs(12)=-9.19234795499921e-07
      cfs(11)=1.37792306998423e-05
      cfs(10)=-0.000160868958499184
      cfs(9)=0.00146295995915231
      cfs(8)=-0.0103193175253849
      cfs(7)=0.0559766730267276
      cfs(6)=-0.230465605549693
      cfs(5)=0.707159956912554
      cfs(4)=-1.5782858148449
      cfs(3)=2.48470003962406
      cfs(2)=-2.68101161898834
      cfs(1)=2.25084149661234
        else
      print *,"bad choice of poly order"
      stop
        endif

      else
      print *,"bad choice of approximation function"
      stop
      endif

      return
      end subroutine getPolyCoeffs

      end module polyapproxmod

